<!DOCTYPE html>
<html>
<head>
	<title>Tartare</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<style type="text/css">
		@import url(http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
		@import url(http://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
		@import url(http://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

		body {
			font-family: 'Droid Serif';
			line-height: 1.75em;
		}
		h1, h2, h3 {
			font-family: 'Yanone Kaffeesatz';
			font-weight: normal;
			margin-bottom: 0.6em;
		}
		.remark-slide-content h1 { font-size: 3em; }
		.remark-slide-content h2 { font-size: 2.5em; }
		.remark-slide-content h3 { font-size: 1.6em; }
		.footnote {
			position: absolute;
			bottom: 3em;
		}
		li {
			line-height: 1.50em;
			margin:0 0 8px 0;
		}
		.large { font-size: 1.5em; }
		a, a > code {
			color: rgb(249, 38, 114);
			text-decoration: none;
		}
		code {
			line-height: 1.25em;
			-moz-border-radius: 12px;
			-web-border-radius: 12px;
			border-radius: 12px;
		}
		.remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
		.left-column {
			float: left;
			width: 50%;
		}
		.right-column {
			float: right;
			width: 50%;
		}
		.clear-column {
			clear: both;
		}
		.inverse {
			background: #272822;
			color: #777872;
			text-shadow: 0 0 20px #333;
		}
		.inverse h1, .inverse h2 {
			color: #f3f3f3;
			line-height: 0.8em;
		}
		.inverse h1 {
			font-size: 5em;
		}
		.inverse h2 {
			font-size: 3em;
		}
		.inverse h3 {
			font-size: 2em;
		}

	</style>
</head>
<body>
<textarea id="source">

	name: inverse
	layout: true
	class: center, middle, inverse

	---

	# TARTARE
	### Making BDD testing with Javascript

	---
	class: center, middle

	## BDD testing concepts

	---
	layout: false

	## Acceptance Tests
	Scenarios that guarantee that customers requirements<br/>
	have been met and the system is acceptable

	## Test automation
	Use of special software to
	- control the execution of tests
	- compare actual outcomes with expected outcomes

	## Tools vs Code

	---

	## BDD (Behaviour Driven Development)

	Tests of any unit of software should be specified in terms of the desired behavior of the unit

	How:
	- Business analysts, developers and testers should collaborate and specify the behavior in terms of user stories
	- Using a semi-formal language shared by all members of the team (both technical and non-technical)

	---

	## BDD (Behaviour Driven Development)

	- Title

	- Narrative:
	  - Who is the driver or primary stakeholder of the story
	  - Which effect the stakeholder wants the story to have
	  - What business value the stakeholder will derive from this effect

	- Acceptance criteria or Scenarios:
	  - Initial condition
	  - Events triggering the start of the scenario
	  - Expected outcome

	---

	## Gherkin

	Business Readable, Domain Specific Language that lets you describe softwareâ€™s behaviour without detailing how that behaviour is implemented

	- Define automated tests
	- Document the system behaviour

	--

	<br/>
	```
	Feature: Some terse yet descriptive text of what is desired
	  Textual description of the business value of this feature
	  Business rules that govern the scope of the feature
	  Any additional information that will make the feature easier to understand

	  Scenario: Some determinable business situation
	    Given some precondition
	      And some other precondition
	     When some action by the actor
	      And some other action
	      And yet another action
	     Then some testable outcome is achieved
	      And something else we can check happens too
	```

	---

	## Data Driven Testing

	- Usage of a table with test inputs and verifiable outputs
	- The tester supplies the inputs from a row in the table and expects the outputs which occur in the same row
	- The table typically contains values which correspond to boundary or partition input spaces
	- It is easy to add additional inputs to the table when new partitions are discovered or added to the product

	--

	<br/>
	```
	Scenario Outline: eating
	  Given there are &lt;start&gt; cucumbers
	   When I eat &lt;eat&gt; cucumbers
	   Then I should have &lt;left&gt; cucumbers

	   Examples:
	     | start | eat | left |
	     |  12   |  5  |  7   |
	     |  20   |  5  |  15  |
	```

	---
	template: inverse

	## Tartare Framework

	---

	## What & Why

	Tartare is a BDD Gherkin framework and a QA tools library

	By the time Tartare was born, existent BDD frameworks for Javascript/Node.js didn't fit our needs:
	- Immature frameworks lacked key features (example tables)
	- Lack of proper hooks
	- Not using Mocha behind the scenes (unit testing is being done with Mocha)
	- Mocha itself use BDD but not Gherkin syntax
	- Asynchronous code may mess up steps implementation (callback hell)

	---

	## Getting started

	Installing tartare:

	```bash
	$ npm install tartare
	```

	Using tartare:

	```bash
	$ tartare test.js
	```

	Generating a markdown report:

	```bash
	$ tartare test.js --reporter gherkin-md --bugid-link "https://github.com..."
	```

	---

	## Exercise Scenario

	<br/>
	```
	Feature: Get users using the API
	  I am able to use the Users API to read the users of the SUT

	  Scenario: Get a user that exists in the SUT
	    Given there is a user with username john in the SUT
	     When I use the API to get the user looking up by his name
	     Then I get a 200 OK HTTP Status Code
	      And the HTTP body has the expected user data
	```

	---

	## New keywords

	<br/>
	```javascript
	feature('Get users using the API',
	        'I am able to use the Users API to read the users of the SUT',
	        function() {
	  scenario('Get a user that exists in the SUT', function() {
	    given('there is a user with username john in the SUT', function() {

	    });
	    when('I use the API to get the user looking up by his name', function() {

	    });
	    then('I get a 200 OK HTTP Status Code', function() {

	    });
	    and('the HTTP body has the expected user data', function() {

	    });
	  });
	});
	```

	---

	## Synchronizing code

	```javascript
	var tartare = require('tartare');
	var steps = require('./steps');
	[...]
	    when('I use the API to get the user looking up by his name', function(done) {
	      steps.getUser('john', function(err, res) {
	        if (err) {
	          return done(err);
	        }
	        response = res;
	        done();
	      });
	    });
	[...]
	```

	```javascript
	var tartare = require('tartare');
	var steps = require('./steps');
	tartare.synchronize(steps);
	[...]
	    when('I use the API to get the user looking up by his name', function(done) {
	      response = steps.getUser('john');
	    });
	[...]
	```

	---

	## DDT: Variants

	<br/>
	```javascript
	feature('Get users using the API', function() {
	  var dataset = [
	    { desc: 'John', user: { name: 'john', email: 'john@doe.com' } },
	    { desc: 'Alice', user: { name: 'alice', email: 'alice@doe.com' } }
	  ];
	  scenario('Get a user that exists in the SUT', dataset, function(variant) {
	    [...]
	    when('I use the API to get the user looking up by his name', function() {
	      response = steps.getUser(variant.user.name);
	    });
	    [...]
	  });
	});
	```

	---

	## Hooks

	.left-column[
	- beforeAll
	- beforeFeature
	- beforeEachScenario
	- beforeScenario
	- beforeEachVariant
	]

	.right-column[
	- afterAll
	- afterFeature
	- afterEachScenario
	- afterScenario
	- afterEachVariant
	]



	.clear-column[
	```javascript
	feature('Get users using the API', function() {
	  beforeFeature(function() {
	    steps.startServer();
	  });

	  scenario('Get a user that exists in the SUT', function() {
	    [...]
	  });

	  afterFeature(function() {
	    steps.stopServer();
	  });
	});
	```
	]

	---

	## Manual tests

	<br/>
	```javascript
	feature('Switch on and off the device', function() {
	  scenario('Switch on the device', function () {
	    given('the device is switched off');
	    when('I press the switch on button');
	    then('the device is up & running');
	  });
	});
	```

	---

	## Only and Skip

	<br/>
	```javascript
	feature('Get users using the API', function() {
	  var dataset = [
	    { desc: 'John', user: { name: 'john', email: 'john@doe.com' } },
	*   { skip: true, desc: 'Alice', user: { name: 'alice', email: 'alice@doe.com' } }
	  ];
	* scenario.only('Get a user that exists in the SUT', dataset, function(variant) {
	    [...]
	  });
	});

	feature('Switch on and off the device', function() {
	  scenario('Switch on the device', function() {
	    [...]
	  });
	});
	```

	---

	## Tags and Filters

	<br/>
	```javascript
	feature('Get users using the API', function() {
	  var dataset = [
	*   { tag: 'critical', desc: 'John', user: { name: 'john', email: 'john@doe.com' } },
	    { desc: 'Alice', user: { name: 'alice', email: 'alice@doe.com' } }
	  ];
	  scenario('Get a user that exists in the SUT', dataset, function(variant) {
	    [...]
	  });
	});

	feature('Switch on and off the device', function() {
	  scenario('Switch on the device', function() {
	    [...]
	* }).tag('critical');
	});
	```

	```bash
	$ tartare test.js --filter +critical
	```

	---

	## Bug Management

	<br/>
	```javascript
	feature('Get users using the API', function() {
	  var dataset = [
	    { desc: 'John', user: { name: 'john', email: 'john@doe.com' } },
	    { desc: 'Alice', user: { name: 'alice', email: 'alice@doe.com' } }
	  ];
	  scenario('Get a user that exists in the SUT', dataset, function(variant) {
	    [...]
	* }).minorBug('1');
	});
	```

	---

	## Tartare as a QA Library

	- Programmable API Server Mock
	- Customized Chai Plugins for HTTP and UNICA APIs
	- An HTTP REST client to make easier testing REST APIs
	- SUT start/stop: A set of functions to manage servers configuration, start and stop

	---

	## Where is Tartare being used

	<br/>
	.large[
	- TDAF reusable components
	- eyeOS
	]
	<br/>

	.left-column[
	<img src="TDAF_Logo.png" width="60%">
	]
	.righ-column[
	<br/><br/><br/>
	<img src="EyeOS_Logo.png" width="40%">
	]

	---
	template: inverse

	# Q & A

	[https://github.com/JoseAntonioRodriguez/tartare-talk](https://github.com/JoseAntonioRodriguez/tartare-talk)

	.footnote[Slideshow created using [remark](http://github.com/gnab/remark).]

</textarea>
<script src="http://gnab.github.io/remark/downloads/remark-latest.min.js" type="text/javascript">
</script>
<script type="text/javascript">
	var slideshow = remark.create({
		ratio: '4:3',
		highlightStyle: 'solarized_light'
	});
</script>
</body>
</html>
